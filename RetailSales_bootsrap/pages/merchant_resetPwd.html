<!doctype html>
<html lang="zh">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <link rel="icon" href="dist/img/hualogo.gif" sizes="32x32" type="image/gif">
  <link rel="icon" href="dist/img/hualogo.gif" sizes="16x16" type="image/gif">
  <meta name="keywords" content="华裳在线汉服网络商城">
  <meta name="description" content="bootstrap华裳在线汉服网络商城">
  <meta name="author" content="ajiho">
  <link rel="stylesheet" href="../lib/bootstrap-icons/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="../lib/bootstrap/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="../lib/bootstrap-table/dist/bootstrap-table.min.css">
  <link rel="stylesheet" href="../lib/@eonasdan/tempus-dominus/dist/css/tempus-dominus.min.css"/>
  <link rel="stylesheet" href="../dist/css/bootstrap-admin.min.css">
  <title>商家重置密码</title>
</head>

<body class="bg-body-tertiary py-3">
<div class="container-fluid">
  <div class="card border-0 shadow-sm">

    <div class="card-header bg-body">
      <h3> 重置用户密码</h3>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-5">
          <form id="form">

            <div class="row mb-3" id="hide_code">
              <label for="username" class="col-sm-3 col-form-label text-sm-end">账号</label>
              <div class="col-sm-9">
                <div class="input-group">
                                        <span class="input-group-text bg-white"><i
                                          class="bi bi-person-vcard"></i></span>
                  <input type="text" class="form-control" id="code" name="code" maxlength="20"
                         tabindex="2" autocomplete placeholder="请输入账号" readonly
                         data-bv-container="#err_username" pattern="^[A-Za-z0-9]{0,20}$">
                </div>
              </div>
            </div>

            <div class="row mb-3">
              <!-- <label for="password" class="col-sm-3 col-form-label text-sm-end">新密码</label> -->
              <!-- <div class="col-sm-9"> -->
              <div class="input-group bsa-show_hide_password">
                                    <span class="input-group-text bg-white"><i
                                      class="bi bi-clipboard2-check"></i></span>
                <input type="password" class="form-control" id="merchantPassword"
                       name="merchantPassword" maxlength="20" tabindex="4" placeholder="请输入新密码"
                       required data-bv-container="#err_password" pattern="^[\S]{0,20}$">
                <span class="input-group-text bg-white bsa-cursor-pointer"><i
                  class="bi bi-eye-slash"></i></span>
                <!-- </div> -->
              </div>
            </div>

            <div class="row mb-3">
              <div class="input-group bsa-show_hide_password">
                <!-- <label for="rePassword" class="col-sm-3 col-form-label text-sm-end">确认新密码</label> -->
                <!-- <div class="col-sm-9"> -->
                <span class="input-group-text bg-white"><i class="bi bi-shield-check"></i></span>
                <input type="password" class="form-control" id="rePassword" name="rePassword"
                       maxlength="20" tabindex="4" placeholder="确认新密码" required
                       data-bv-container="#err_password" pattern="^[\S]{0,20}$">
                <span class="input-group-text bg-white bsa-cursor-pointer"><i
                  class="bi bi-eye-slash"></i></span>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-sm-9 offset-sm-3">
                <button type="submit" class="btn btn-primary">确认重置密码</button>
              </div>
            </div>

          </form>
        </div>

      </div>


    </div>
  </div>


  <!-- <div class="card-header bg-body py-3">
<form class="row row-cols-sm-auto g-3 align-items-center" action="#">
  <div class="col-12">
    <div class="row">
      <label for="name" class="col-sm-auto col-form-label">角色名称</label>
      <div class="col">
        <input type="text" class="form-control" id="name" name="name">
      </div>
    </div>
  </div>

  <div class="col-12 gap-2">

    <button type="button" class="btn btn-light bsa-querySearch-btn">
      <i class="bi bi-search"></i>搜索
    </button>
    <button type="button" class="btn btn-light bsa-reset-btn">
      <i class="bi bi-arrow-clockwise"></i>重置
    </button>
  </div>

</form>
</div> -->

  <!-- <div class="card-body">
<table id="table"></table>

</div> -->

  <!-- <div class="card-footer bg-body">
<button class="btn btn-light btn-submit">确定</button>
</div> -->

</div>
</div>
<!--回到顶部开始-->
<a href="javaScript:" class="bsa-back-to-top"><i class='bi bi-arrow-up-short'></i></a>
<!--回到顶部结束-->


<script src="../lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="../lib/jquery/dist/jquery.min.js"></script>

<script src="../lib/formvalidation/js/formValidation.js"></script>
<script src="../lib/formvalidation/js/framework/bootstrap.js"></script>
<script src="../lib/formvalidation/js/language/zh_CN.js"></script>

<!-- <script src="../lib/@popperjs/core/dist/umd/popper.min.js"></script>
<script src="../lib/@eonasdan/tempus-dominus/dist/js/tempus-dominus.min.js"></script>
<script src="../lib/bootstrap-table/dist/bootstrap-table.min.js"></script>
<script src="../lib/bootstrap-table/dist/locale/bootstrap-table-zh-CN.min.js"></script> -->

<script src="../dist/js/bootstrap-admin.min.js"></script>
<script src="../dist/js/app.js"></script>

<script type="text/javascript" src="../dist/js/rockjs-1.0.js"></script>
<script type="text/javascript" src="../pagejs/common.js"></script>
<script>

  $(function ($) {
    $("#hide_code").hide();
    // 从 sessionStorage 中获取数据并解析为对象
    var selectedUserData = JSON.parse(sessionStorage.getItem('selectedUserData'));
    $("#code").attr("value", selectedUserData.code);

    //前端表单验证
    $('#form').formValidation({
      fields: {
        merchantPassword: {
          validators: {
            notEmpty: {
              message: '密码不能为空'
            },
            stringLength: {
              min: 6,
              max: 20,
              message: '密码长度必须在6到20个字符之间'
            }
          },

        },
        rePassword: {
          validators: {
            notEmpty: {
              message: '密码不能为空'
            },

            identical: {//相同
              field: 'merchantPassword',
              message: '两次密码不一致'
            }
          }
        }
      }
    }).on('success.form.fv', function (e) {
      //阻止表单提交
      e.preventDefault();
      // 得到表单对象
      let $form = $(e.target);
      // 获取表单数据
      let formData = $form.serializeArray();
      // 将序列化数据转换为字符串
      let data = $.param(formData);
      $.ajax({
        //跨域
        xhrFields: {
          withCredentials: true
        },
        url: "http://127.0.0.1:8082/hanfushopping/merchant/resetPwd",
        method: 'POST',
        data: data
      }).then(response => {
        if (response.result) {
          $.toasts({
            type: 'success',
            content: '重置密码成功！',
            delay: 1000, // 显示的时间（毫秒）
            autohide: true,
            onHidden: function () {
              parent.rolemodal.setData(true);
              parent.rolemodal.close();
            }
          });

        } else {
          $.toasts({
            type: 'danger',
            content: '修改密码失败！',

          });

        }


      });


    });

  });


</script>

</body>

</html>
